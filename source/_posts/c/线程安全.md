---
title: 线程安全
date: 2018-03-26 11:30:18
categories:
- c
---

## 线程安全
线程安全可以简单理解为一个方法或者一个实例可以在多线程环境中使用而不会出现问题。

## 产生线程不安全的原因
在同一程序中运行多个线程本身不会导致问题，问题在于多个线程访问了相同的资源。如，同一内存区（变量，数组，或对象）、系统（数据库，web services等）或文件。
实际上，这些问题只有在__一或多个线程向这些资源做了写操作时才有可能发生__，只要资源没有发生变化,多个线程读取相同的资源就是安全的。
<!--more-->
## 同步机制
当两个线程竞争同一资源时，如果对资源的访问顺序敏感，就称存在竞态条件。导致竞态条件发生的代码区称作临界区。
在临界区中使用适当的同步就可以避免竞态条件。

kernel大致的同步机制如下：
1. atomic
2. spin lock
3. semaphore
4. mutex
5. completion
